{% extends 'PaperTrail_App/base.html' %}
{% block extra_headers %}
  <!-- Annotorious CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@recogito/annotorious@2.7.12/dist/annotorious.min.css" />
  <!-- Annotorious JS -->
  <script src="https://cdn.jsdelivr.net/npm/@recogito/annotorious@2.7.12/dist/annotorious.min.js"></script>
{% endblock %}
{% block side_bar %}

{% endblock %}
{% block body %}
  <div>
    <div class="lead">Document Details</div>
    <ul>
      <li>{{ document }}</li>
      <li>{{ document.doc.url }}</li>
      <li>{{ document.doc_name }}</li>
      <li>{{ document.created }}</li>
      <li>{{ document.doc_type }}</li>
    </ul>
  </div>
  <div class="d-flex justify-content-center align-items-center py-5">
    <div style="height: auto; width: 90vw;">
      <img id="document" src="{{ document.doc.url }}" class="img-fluid" alt="image" />
    </div>
  </div>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      loadAnnotorious()
      
    })
    
    function fun1(purpose, annotation) {
      console.log(purpose)
      console.log(annotation)
      console.log(annotation.annotation)
    }
    function loadAnnotorious() {
      var anno = Annotorious.init({
        image: 'document',
        widgets: ['COMMENT']
      })
      anno.on('createAnnotation', function (annotation) {
        fun1('Create', annotation)
      })
      anno.on('updateAnnotation', function (annotation) {
        fun1('Update', annotation)
      })

      // Load old annotations
      myAnnotation = {
        // "@context": "http://www.w3.org/ns/anno.jsonld",
        type: 'Annotation',
        body: [
          {
            type: 'TextualBody',
            value: 'A',
            purpose: 'commenting'
          }
        ],
        target: {
          //  source: "http://127.0.0.1:5500/bb/image.jpg",
          selector: {
            type: 'FragmentSelector',
            conformsTo: 'http://www.w3.org/TR/media-frags/',
            value: 'xywh=pixel:2439.829345703125,1265.1448974609375,1912.778564453125,1295.2672119140625'
          }
        },
        id: '1'
      }
    
      anno.addAnnotation(myAnnotation) 
    }
  </script>
{% endblock %}
